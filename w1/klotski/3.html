<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Uge 1 - Opgave 3</title>
<link href="style.css" rel="stylesheet" type="text/css" />
<link href="layout.css" rel="stylesheet" type="text/css" />
<style>
#theBoard {
	height:400px;
	width:500px;
	background-color:#000;
}
</style>
<script>

// Mouse click detection
// Keyboardspresses
// Scoreboards/Winner screen


function Block(width, height, x, y, isWall, isWinner, isPlayer, color){
	this.width = width;
	this.height = height;
	this.x = x;
	this.y = y;
	this.isWall = isWall;
	this.isWinner = isWinner;
	this.isPlayer = isPlayer;
	this.color = color;
}

function Game(initialBoard){
	this.board = initialBoard
	this.moves = 0;
	this.record = 0;
	this.moveBlock = function (direction,block){
		if(direction == "right"){
			if(this.checkCollision((block.x+1), block.y)){
				this.updateBoard (block, (block.x+1), block.y)
			}
		}
		if(direction == "left"){
			if(this.checkCollision((block.x-1), block.y)){
				this.updateBoard (block, (block.x-1), block.y)
			}
		}
		if(direction == "down"){
			if(this.checkCollision(block.x, (block.y+1))){
				this.updateBoard (block, block.x, (block.y+1))
			}
		}
		if(direction == "up"){
			if(this.checkCollision(block.x, (block.y-1))){
				this.updateBoard (block, block.x, (block.y-1))
			}
		}
	
		this.draw();
	};
	this.checkCollision = function (block,x,y){
		var granted = true;
		var newBlock = new Block(block.width, block.height, x, y, block.isWall, block.isWinner, block.isPlayer, block.color);
		for(var i = 0; i<this.board.length; i++){
			var currentBlock = this.board[i];
			if(this.isTouching(newBlock,currentBlock)){
				granted = false;	
			}
		}
		if(block.isPlayer = true){
			if(this.isWinning(block)){
				this.updateScores();	
			}
		}
		if(granted){
			this.moves++;	
		}
		return granted;
	};
	
	this.isTouching = function (newBlock, block){
		var newX = newBlock.x+newBlock.width;
		var newY = newBlock.y+newBlock.height;
		if(newX <= block.x && newBlock.x >= block.x+block.width && newY <= block.y && newBlock.y >= block.x+block.height){
			return true;	
		}else{
			return false;	
		}
	}
	
	this.isTouchingStrict = function (block){
		var notTouchingAnythingElse = false;
		for(var i = 0; i<this.board.length; i++){
			if(this.board[i].isWinner=true && isTouching(this.board[i],block)){
				notTouchingAnythingElse = true
			}
			if(this.board[i].isWinner=false && isTouching(this.board[i],block)){
				notTouchingAnythingElse = false	
			}
			
		}
	}
	
	this.updateScores = function() {
		// TODO
	}
	
	this.isWinning = function(block){
		var wonned = false;
		for(var i = 0; i<this.board.length; i++){
			if(this.board[i].isWinning){
				if(this.isTouchingStrict(this.board[i],block)){
					wonned = true;	
				}
			}
		}
		return wonned;
	}
	
	this.draw = function (){
		
	};
	this.updateBoard = function(block,x,y){
		for(var i = 0; i<this.board.length; i++){
			if(this.board[i] === block){
				block.x = x;
				block.y = y;
				this.board[i] = block
				
			}
		}
	}
}
</script>
</head>

<body>
<div id="theBoard">

</div>
</body>
</html>
